
Настройка простого приложения с PostgreSQL, NodeJS, Nginx

Dockerfile

FROM ubuntu:14.04
RUN apt-get update && apt-get install postgresql nodejs npm nginx
WORKDIR /opt
COPY . /opt/ # {*}
RUN service postgresql start && cat db/schema.sql | psql && service postgresql stop
RUN cd app && npm install
RUN cp conf/mysite /etc/nginx/sites-available/ && cd /etc/nginx/sites-enabled && ln -s ../sites-available/mysite

Dockerfile  для монолитного приложения

FROM ubuntu:14.04
RUN apt-get update && apt-get install postgresql nodejs npm nginx
WORKDIR /opt
COPY db /opt/db
RUN service postgresql start && cat db/schema.sql | psql && service postgresql stop
COPY app /opt/app
RUN cd app && npm install
RUN cd app && ./minify_static.sh
COPY conf /opt/conf
RUN cp conf/mysite /etc/nginx/sites-available/ && cd /etc/nginx/sites-enabled && ln -s ../sites-available/mysite
